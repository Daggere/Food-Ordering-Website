"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const command_1=require("@oclif/command"),nimbella_deployer_1=require("nimbella-deployer"),nimbella_deployer_2=require("nimbella-deployer"),clients_1=require("../../storage/clients"),util_1=require("../../storage/util");class WebList extends nimbella_deployer_1.NimBaseCommand{async runCommand(e,t,a,i,n){const{client:s}=await clients_1.getWebStorageClient(a,i,nimbella_deployer_2.authPersister);s||n.handleError(`Couldn't get to the web storage, ensure it's enabled for the ${i.namespace||"current"} namespace`),await this.listFiles(s,n,i.long,a.prefix).catch(e=>n.handleError("",e))}async listFiles(e,t,a,i){const[n]=await e.getFiles({prefix:i});if(0===n.length)return t.log("No content available "+(i?`matching prefix '${i}'`:""));a?await util_1.fileMetaLong(n,e,t).catch(e=>t.handleError(e)):await util_1.fileMetaShort(n,e,t).catch(e=>t.handleError(e))}}exports.default=WebList,WebList.description="Lists Web Content",WebList.flags=Object.assign({apihost:command_1.flags.string({description:"API host of the namespace to list web content from"}),long:command_1.flags.boolean({char:"l",description:"Displays additional file info such as last update, owner and md5hash"}),namespace:command_1.flags.string({description:"The namespace to list web content from (current namespace if omitted)"})},nimbella_deployer_1.NimBaseCommand.flags),WebList.args=[{name:"prefix",description:"Prefix to match the content against",required:!1,default:""}];
