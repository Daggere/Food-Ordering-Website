"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getObjectStorageClient=exports.getWebStorageClient=void 0;const storage_1=require("@google-cloud/storage"),nimbella_deployer_1=require("nimbella-deployer");async function getStorageClient(e,t,a,o=""){let r,n=t.namespace,i=t.apihost;n?r=await nimbella_deployer_1.getCredentialsForNamespace(n,t.apihost,a):(r=await nimbella_deployer_1.getCredentials(a),n=r.namespace),i=r.ow.apihost;const l=r.storageKey,g=nimbella_deployer_1.computeBucketStorageName(i,n);if(!l)return{bucketName:g,storage:void 0,client:void 0,creds:void 0};const s=new storage_1.Storage(l),c=s.bucket(o+g);return{bucketName:g,storage:s,client:c,creds:r}}async function getWebStorageClient(e,t,a){return await getStorageClient(e,t,a)}async function getObjectStorageClient(e,t,a){return await getStorageClient(e,t,a,"data-")}exports.getWebStorageClient=getWebStorageClient,exports.getObjectStorageClient=getObjectStorageClient;
